import numpy as np
import matplotlib.pyplot as plt

'''
PRM_plus_SRM = np.array([[13065696, 8184894, 307223, 2081399, 848897, 902042, 472641, 1389711, 1329373, 7129772, 14470629, 4778842, 3863606, 5109471, 4256460, 20732485, 51922597, 64809593, 50757337, 38893944, 18353058, 10540727, 8669864, 6820977, 5220927, 4158874, 3294135, 2661864, 2199605, 1753639, 1448014, 1148243, 928431, 1336808, 843252, 541196, 341269, 221256, 151162, 99693, 64753, 38916, 25572, 17841, 12044, 7896, 5646, 4055, 4761, 3438], 
[44836, 28863, 697, 5364, 1828, 2232, 1472, 4030, 3097, 10028, 29313, 9549, 9239, 12475, 15424, 65157, 191951, 285251, 234806, 211655, 129649, 78551, 89934, 97573, 100193, 100565, 96579, 95035, 91410, 90331, 80784, 72603, 74732, 147291, 110039, 90677, 76381, 57397, 45779, 36130, 28231, 20669, 15463, 12150, 10267, 7311, 5539, 4171, 5704, 5653]])
'''

PRM_plus_SRM = np.array([[1745583, 6732907, 11716185, 3657322, 2796669, 2063286, 4365045, 28051509, 61943616, 32921974, 12103312, 6443053, 3421430, 1802394, 878618, 454642, 233098, 121388, 67205, 38153, 21974, 13226, 8340, 5143, 3359, 2053, 1371, 912, 619, 1017],
[11991, 37006, 62686, 22299, 24011, 24232, 36895, 235522, 579262, 471216, 336415, 300320, 257893, 198738, 137124, 95539, 63754, 43210, 28280, 19303, 12131, 7500, 4927, 3061, 2048, 1254, 849, 583, 369, 472]])

noPeaks = np.sum(PRM_plus_SRM[0])
peaks = np.sum(PRM_plus_SRM[1])
peakProb = peaks / (peaks+noPeaks)

print("PRM+SRM peakProb ", peakProb )

'''PRM = np.array([[13065696, 8184894, 307223, 2081399, 848897, 901729, 472332, 1133001, 619506, 601400, 674436, 610984, 574142, 490298, 621516, 4819728, 14755799, 40631634, 32257126, 18911117, 13566791, 5573426, 4922783, 3470560, 2812239, 2207101, 1639066, 1325963, 1084052, 911137, 728247, 540146, 426018, 534930, 302917, 181445, 111013, 68389, 44305, 30466, 20722, 14239, 10630, 7335, 4873, 3131, 2178, 1682, 2213, 1410], [44836, 28863, 697, 5364, 1828, 2232, 1472, 3815, 2426, 2940, 3686, 4265, 4316, 4255, 4562, 29718, 77717, 205521, 159621, 112356, 100068, 39856, 48471, 47806, 49638, 50045, 43790, 45417, 41310, 42696, 37575, 29304, 29084, 53275, 37756, 30579, 23896, 17725, 13220, 10200, 7893, 5696, 4187, 3360, 2710, 1896, 1247, 917, 1205, 717]])'''


PRM = np.array([[21557813, 2930296, 1374061, 1752507, 1275836, 1185126, 1111814, 19575527, 72888760, 32477908, 10496209, 6282799, 3846167, 2410015, 1639384, 966164, 534930, 302917, 181445, 111013, 68389, 44305, 30466, 20722, 14239, 10630, 7335, 4873, 3131, 7483], [74396, 7192, 3704, 6241, 6626, 8581, 8817, 107435, 365142, 212424, 88327, 97444, 93835, 86727, 80271, 58388, 53275, 37756, 30579, 23896, 17725, 13220, 10200, 7893, 5696, 4187, 3360, 2710, 1896, 4086]]) 

noPeaks = np.sum(PRM[0])
peaks = np.sum(PRM[1])
peakProb = peaks / (peaks+noPeaks)


print("PRM peakProb ", peakProb )


'''SRM = np.array([[0, 0, 0, 0, 0, 313, 309, 256710, 709867, 6528372, 13796193, 4167858, 3289464, 4619173, 3634944, 15912757, 37166798, 24177959, 18500211, 19982827, 4786267, 4967301, 3747081, 3350417, 2408688, 1951773, 1655069, 1335901, 1115553, 842502, 719767, 608097, 502413, 801878, 540335, 359751, 230256, 152867, 106857, 69227, 44031, 24677, 14942, 10506, 7171, 4765, 3468, 2373, 2548, 2028], [0, 0, 0, 0, 0, 0, 0, 215, 671, 7088, 25627, 5284, 4923, 8220, 10862, 35439, 114234, 79730, 75185, 99299, 29581, 38695, 41463, 49767, 50555, 50520, 52789, 49618, 50100, 47635, 43209, 43299, 45648, 94016, 72283, 60098, 52485, 39672, 32559, 25930, 20338, 14973, 11276, 8790, 7557, 5415, 4292, 3254, 4499, 4936]]) 
'''

SRM = np.array([[0, 0, 622, 966577, 20324565, 7457322, 8254117, 53079555, 42678170, 24769094, 8714382, 5759105, 3606842, 2451454, 1562269, 1110510, 801878, 540335, 359751, 230256, 152867, 106857, 69227, 44031, 24677, 14942, 10506, 7171, 4765, 10417], [0, 0, 0, 886, 32715, 10207, 19082, 149673, 154915, 128880, 80158, 100322, 103309, 99718, 90844, 88947, 94016, 72283, 60098, 52485, 39672, 32559, 25930, 20338, 14973, 11276, 8790, 7557, 5415, 16981]])



noPeaks = np.sum(SRM[0])
peaks = np.sum(SRM[1])
peakProb = peaks / (peaks+noPeaks)


print("PRM peakProb ", peakProb )


x_axis = [-9.0, -8.0, -7.0, -6.0, -5.0, -4.0, -3.0, -2.0, -1.0,
               0.0,  1.0,  2.0,  3.0,  4.0,  5.0,  6.0,  7.0,  8.0,  9.0,
               10.0,11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0]

'''
x_axis = [-11.0, -10.0,  -9.5, -9.0, -8.5,  -8.0,  -7.5,  -7.0,  -6.5,  -6.0,
               -5.5,  -5.0, -4.5, -4.0,  -3.5,  -3.0,  -2.5,  -2.0,  -1.5,  -1.0,
               -0.5,   0.0,  0.5,  1.0,   1.5,   2.0,   2.5,   3.0,  3.5, 4.0,
                4.5,   5.0,  5.5,  6.0,   7.0,   8.0,  9.0,  10.0,   11.0, 12.0, 
                13.0, 14.0,  15.0,16.0,  17.0,  18.0, 19.0,  20.0,   21.0, 23.0];
'''



PRM_plus_SRM_colProbs = []

for i in range(0, PRM_plus_SRM.shape[1]):
    if(PRM_plus_SRM[0][i] + PRM_plus_SRM[1][i] != 0):
        colProb = PRM_plus_SRM[1][i] / (PRM_plus_SRM[0][i] + PRM_plus_SRM[1][i])
    else:
        colProb = 0
    print(colProb, end =", ")
    PRM_plus_SRM_colProbs.append(colProb)
print()
plt.plot(x_axis, PRM_plus_SRM_colProbs, label = 'PRM plus SRM')

PRM_colProbs = []



for i in range(0, PRM.shape[1]):
    if(PRM[0][i] + PRM[1][i] != 0):
        colProb = PRM[1][i] / (PRM[0][i] + PRM[1][i])
    else:
        colProb = 0
    print(colProb, end =", ")
    PRM_colProbs.append(colProb)
print()
plt.plot(x_axis, PRM_colProbs, label = 'PRM')

SRM_colProbs = []

for i in range(0, SRM.shape[1]):
    if(SRM[0][i] + SRM[1][i] != 0):
        colProb = SRM[1][i] / (SRM[0][i] + SRM[1][i])
    else:
        colProb = 0
    print(colProb, end =", ")
    SRM_colProbs.append(colProb)
print()
plt.plot(x_axis, SRM_colProbs, label = 'SRM')


plt.xlabel('Prefix-Residue-Mass Score')
plt.ylabel('Probability of Theoretical Peak')

i
plt.legend()
plt.show()

#print(PRM_plus_SRM)
